
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mado QR Studio | Ultra Light Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap');
        body { font-family: 'Cairo', sans-serif; background: #020617; color: white; min-height: 100vh; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .input-field { background: rgba(15, 23, 42, 0.8); border: 1px solid rgba(255, 255, 255, 0.1); padding: 12px; border-radius: 12px; width: 100%; outline: none; color: white; font-size: 13px; }
        .active-tab { background: #3b82f6 !important; box-shadow: 0 0 15px rgba(59, 130, 246, 0.5); }
        .iphone-frame { width: 260px; height: 500px; border: 8px solid #1e293b; border-radius: 35px; position: relative; overflow: hidden; background: #0f172a; margin: 0 auto; }
        .iphone-notch { width: 100px; height: 18px; background: #1e293b; position: absolute; top: 0; left: 50%; transform: translateX(-50%); border-bottom-left-radius: 12px; border-bottom-right-radius: 12px; z-index: 10; }
        .bio-btn-preview { width: 100%; padding: 8px; border-radius: 10px; margin-bottom: 6px; font-size: 10px; font-weight: bold; text-align: center; color: white; display: block; }
        .contact-pill { padding: 4px 10px; border-radius: 20px; background: rgba(255,255,255,0.1); font-size: 8px; color: white; border: 1px solid rgba(255,255,255,0.1); }
    </style>
</head>
<body class="p-4 lg:p-10">
    <div id="creator-ui" class="max-w-7xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-indigo-400 italic">MaDo QR Pro</h1>
            <p class="text-gray-500 text-[10px] mt-2 uppercase tracking-widest">Ultra-Light Minimalist Design</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 items-start">
            <div class="lg:col-span-4 space-y-4">
                <div class="glass p-5 rounded-[2rem]">
                    <div class="flex p-1 bg-black/40 rounded-xl gap-1 mb-4 overflow-x-auto">
                        <button onclick="switchTab('url')" id="tab-url" class="tab-btn flex-1 py-2 rounded-lg text-[10px] font-bold transition">Ø±Ø§Ø¨Ø·</button>
                        <button onclick="switchTab('vcard')" id="tab-vcard" class="tab-btn active-tab flex-1 py-2 rounded-lg text-[10px] font-bold transition">vCard</button>
                        <button onclick="switchTab('wifi')" id="tab-wifi" class="tab-btn flex-1 py-2 rounded-lg text-[10px] font-bold transition">WiFi</button>
                        <button onclick="switchTab('bio')" id="tab-bio" class="tab-btn flex-1 py-2 rounded-lg text-[10px] font-bold transition text-yellow-400">Identity</button>
                    </div>
                    <div id="dynamic-fields" class="space-y-3"></div>
                </div>

                <div class="glass p-5 rounded-[2rem] space-y-3">
                    <span class="text-[10px] font-bold text-gray-500 uppercase italic">Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØªØ®ØµÙŠØµ</span>
                    <div class="grid grid-cols-2 gap-2">
                        <input type="color" id="qr-fill" value="#3b82f6" oninput="generateFinalMadoQR()" class="w-full h-8 bg-transparent cursor-pointer">
                        <input type="color" id="qr-bg" value="#ffffff" oninput="generateFinalMadoQR()" class="w-full h-8 bg-transparent cursor-pointer">
                    </div>
                    <select id="dot-style" onchange="generateFinalMadoQR()" class="input-field text-xs">
                        <option value="extra-rounded">Ù†Ù‚Ø§Ø· Ø§Ù†Ø³ÙŠØ§Ø¨ÙŠØ© Ù…ØªØ¨Ø§Ø¹Ø¯Ø©</option>
                        <option value="dots">Ù†Ù‚Ø§Ø· Ø¯Ø§Ø¦Ø±ÙŠØ© ØµØºÙŠØ±Ø©</option>
                        <option value="classy">Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ø®Ø·ÙˆØ·</option>
                        <option value="square">Ù…Ø±Ø¨Ø¹Ø§Øª Ø¨Ø³ÙŠØ·Ø©</option>
                    </select>
                    <button onclick="generateFinalMadoQR()" class="w-full bg-blue-600 p-4 rounded-xl font-black text-lg shadow-lg hover:bg-blue-500 transition-all">Ø§Ù†Ø´Ø§Ø¡ Ø¨Ø§Ø±ÙƒÙˆØ¯ </button>
                </div>
            </div>

            <div class="lg:col-span-4">
                <div id="preview-section" class="transition-all duration-500">
                    <div class="iphone-frame" id="live-bg">
                        <div class="iphone-notch"></div>
                        <div id="preview-content" class="p-6 pt-12 flex flex-col h-full overflow-y-auto"></div>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-4 flex flex-col items-center justify-center">
                <div id="qr-target" class="bg-white p-6 rounded-[2.5rem] shadow-2xl hidden"></div>
                <div id="qr-placeholder" class="text-gray-800 border-2 border-dashed border-gray-800 p-20 rounded-[2.5rem] text-sm italic text-center">Ø³ÙŠØ¸Ù‡Ø± Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯<br>Ø¨Ù†Ù‚Ø§Ø· Ø®ÙÙŠÙØ© Ù‡Ù†Ø§</div>
                
                <div id="dl-group" class="hidden flex gap-2 mt-6 w-full max-w-[240px]">
                    <button onclick="downloadQR('png')" class="flex-1 bg-white text-black py-3 rounded-xl font-bold text-xs hover:bg-gray-100">PNG</button>
                    <button onclick="downloadQR('svg')" class="flex-1 bg-blue-500 text-white py-3 rounded-xl font-bold text-xs hover:bg-blue-400">SVG</button>
                </div>
            </div>
        </div>
    </div>

    <div id="viewer-ui" class="hidden min-h-screen flex flex-col items-center p-10 text-center">
        <div id="v-icon" class="w-20 h-20 rounded-full flex items-center justify-center text-3xl mb-4 shadow-xl">ğŸ‘¤</div>
        <h2 id="v-name" class="text-3xl font-black"></h2>
        <p id="v-desc" class="text-sm opacity-70 mt-2 mb-8 max-w-sm leading-relaxed"></p>
        <div id="v-links" class="w-full max-w-sm px-4"></div>
        <div id="v-contacts" class="flex flex-wrap justify-center gap-3 mt-10"></div>
    </div>

    <script>
        let qrCode;
        let currentTab = 'vcard';

        const fields = {
            url: `<input type="text" id="m-url" placeholder="https://..." class="input-field">`,
            wifi: `<input type="text" id="w-ssid" placeholder="Ø§Ø³Ù… Ø§Ù„Ø´Ø¨ÙƒØ©" class="input-field"><input type="password" id="w-pass" placeholder="Ø§Ù„Ø±Ù…Ø²" class="input-field">`,
            vcard: `<div class="space-y-2">
                    <input type="text" id="vc-fn" oninput="live()" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" class="input-field">
                    <input type="text" id="vc-tel" oninput="live()" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„" class="input-field">
                    <input type="text" id="vc-em" oninput="live()" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" class="input-field">
                    <input type="text" id="vc-org" oninput="live()" placeholder="Ø§Ù„Ø´Ø±ÙƒØ©" class="input-field">
                    <input type="text" id="vc-tit" oninput="live()" placeholder="Ø§Ù„Ù…Ù†ØµØ¨" class="input-field">
                  </div>`,
            bio: `<div class="space-y-3">
                    <div class="flex gap-2"><input type="color" id="acc-c" oninput="live()" value="#3b82f6" class="w-1/2 h-8 bg-transparent"><input type="color" id="bg-c" oninput="live()" value="#0f172a" class="w-1/2 h-8 bg-transparent"></div>
                    <input type="text" id="b-n" oninput="live()" placeholder="Ø§Ù„Ø§Ø³Ù…" class="input-field">
                    <textarea id="b-d" oninput="live()" placeholder="Ø§Ù„Ù†Ø¨Ø°Ø©..." class="input-field h-14"></textarea>
                    <div id="l-box" class="space-y-1"><div class="flex gap-1"><input type="text" oninput="live()" placeholder="Ø§Ø³Ù… Ø§Ù„Ø±Ø§Ø¨Ø·" class="ln input-field text-[10px]"><input type="text" placeholder="URL" class="lu input-field text-[10px]"></div></div>
                    <button onclick="addR('l-box')" class="text-[10px] text-blue-400">+ Ø±Ø§Ø¨Ø·</button>
                    <div id="c-box" class="space-y-1 mt-2"><div class="flex gap-1"><input type="text" oninput="live()" placeholder="ÙˆØ§ØªØ³Ø§Ø¨" class="cn input-field text-[10px]"><input type="text" oninput="live()" placeholder="Ø§Ù„Ø±Ù‚Ù…" class="cv input-field text-[10px]"></div></div>
                  </div>`
        };

        function switchTab(t) {
            currentTab = t;
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active-tab'));
            document.getElementById('tab-'+t).classList.add('active-tab');
            document.getElementById('dynamic-fields').innerHTML = fields[t];
            live();
        }

        function addR(id) {
            const div = document.createElement('div'); div.className = "flex gap-1 mt-1";
            const cl = id==='l-box'?['ln','lu']:['cn','cv'];
            div.innerHTML = `<input type="text" oninput="live()" placeholder="Ø§Ù„Ø§Ø³Ù…" class="${cl[0]} input-field text-[10px]"><input type="text" placeholder="Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª" class="${cl[1]} input-field text-[10px]">`;
            document.getElementById(id).appendChild(div);
        }

        function live() {
            const content = document.getElementById('preview-content');
            const bg = document.getElementById('live-bg');
            content.innerHTML = "";
            bg.style.backgroundColor = "#0f172a";

            if(currentTab === 'vcard') {
                const n = document.getElementById('vc-fn').value || "Ø§Ù„Ø§Ø³Ù…";
                content.innerHTML = `<div class="m-auto text-center w-full">
                    <div class="w-16 h-16 bg-blue-600 rounded-full mx-auto mb-4 flex items-center justify-center text-2xl shadow-xl">ğŸ‘¤</div>
                    <h4 class="font-bold text-lg">${n}</h4>
                    <p class="text-blue-400 text-xs mt-1">${document.getElementById('vc-tit').value || "Ø§Ù„Ù…Ù†ØµØ¨ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ"}</p>
                    <div class="mt-6 space-y-2 px-4">
                        <div class="glass p-3 rounded-xl text-[10px] text-left">ğŸ“± ${document.getElementById('vc-tel').value || '---'}</div>
                        <div class="glass p-3 rounded-xl text-[10px] text-left">ğŸ“§ ${document.getElementById('vc-em').value || '---'}</div>
                    </div>
                </div>`;
            } else if(currentTab === 'bio') {
                const acc = document.getElementById('acc-c').value;
                bg.style.backgroundColor = document.getElementById('bg-c').value;
                let html = `<div class="w-14 h-14 rounded-2xl mx-auto mb-3 shadow-xl" style="background:${acc}"></div>`;
                html += `<h4 class="font-bold text-sm text-center">${document.getElementById('b-n').value || "Ø§Ù„Ø§Ø³Ù…"}</h4>`;
                const desc = document.getElementById('b-d').value;
                if(desc) html += `<p class="text-[9px] text-gray-400 text-center mt-2 px-6">${desc}</p>`;
                html += `<div class="mt-6 space-y-2">`;
                Array.from(document.querySelectorAll('.ln')).forEach(input => {
                    if(input.value) html += `<div class="bio-btn-preview shadow-sm" style="background:${acc}">${input.value}</div>`;
                });
                html += `</div><div class="mt-auto flex flex-wrap justify-center gap-2 pb-6">`;
                Array.from(document.querySelectorAll('.cn')).forEach(input => {
                    if(input.value) html += `<span class="contact-pill">${input.value}</span>`;
                });
                html += `</div>`;
                content.innerHTML = html;
            }
        }

        function generateFinalMadoQR() {
            let txt = "";
            if(currentTab === 'url') txt = document.getElementById('m-url').value;
            else if(currentTab === 'wifi') txt = `WIFI:S:${document.getElementById('w-ssid').value};P:${document.getElementById('w-pass').value};;`;
            else if(currentTab === 'vcard') {
                // Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù†Ù‚Ø§Ø· 60% ÙÙŠ vCard Ù†ÙƒØªÙÙŠ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„ØªØ®Ø²ÙŠÙ†
                txt = `BEGIN:VCARD\nFN:${document.getElementById('vc-fn').value}\nTEL:${document.getElementById('vc-tel').value}\nEND:VCARD`;
            } else if(currentTab === 'bio') {
                // ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„Ù€ Object Ù„ÙŠØ¸Ù„ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ "Ø®ÙÙŠÙØ§Ù‹"
                const d = { 
                    n:document.getElementById('b-n').value, 
                    d:document.getElementById('b-d').value, 
                    a:document.getElementById('acc-c').value, 
                    b:document.getElementById('bg-c').value,
                    l:Array.from(document.querySelectorAll('#l-box .flex')).map(r=>({n:r.querySelector('.ln').value, u:r.querySelector('.lu').value})).filter(x=>x.n),
                    t:Array.from(document.querySelectorAll('#c-box .flex')).map(r=>({n:r.querySelector('.cn').value, v:r.querySelector('.cv').value})).filter(x=>x.n)
                };
                txt = window.location.href.split('#')[0] + "#" + btoa(unescape(encodeURIComponent(JSON.stringify(d))));
            }

            if(!txt) return;

            const target = document.getElementById('qr-target');
            target.innerHTML = "";
            target.classList.remove('hidden');
            document.getElementById('qr-placeholder').classList.add('hidden');
            document.getElementById('dl-group').classList.remove('hidden');

            qrCode = new QRCodeStyling({
                width: 280,
                height: 280,
                data: txt,
                qrOptions: { typeNumber: 0, mode: 'Byte', errorCorrectionLevel: 'L' }, // Ø³Ø± Ø§Ù„Ø¨Ø³Ø§Ø·Ø©
                dotsOptions: { 
                    color: document.getElementById('qr-fill').value, 
                    type: document.getElementById('dot-style').value,
                },
                backgroundOptions: { color: document.getElementById('qr-bg').value },
                cornersSquareOptions: { type: 'extra-rounded', color: document.getElementById('qr-fill').value },
                cornersDotOptions: { type: 'dot', color: document.getElementById('qr-fill').value }
            });
            qrCode.append(target);
        }

        function downloadQR(ext) { qrCode.download({ name: "Mado_QR", extension: ext }); }

        function checkViewer() {
            const h = window.location.hash.substring(1);
            if(h && h.length > 30) {
                try {
                    const d = JSON.parse(decodeURIComponent(escape(atob(h))));
                    document.getElementById('creator-ui').style.display='none';
                    document.getElementById('viewer-ui').classList.remove('hidden');
                    document.body.style.background = d.b;
                    document.getElementById('v-icon').style.backgroundColor = d.a;
                    document.getElementById('v-name').innerText = d.n;
                    document.getElementById('v-desc').innerText = d.d;
                    document.getElementById('v-links').innerHTML = d.l.map(l => `<a href="${l.u}" class="w-full block p-4 rounded-2xl mb-3 font-bold text-white shadow-lg" style="background:${d.a}">${l.n}</a>`).join('');
                } catch(e) {}
            }
        }

        window.onload = () => { switchTab('vcard'); checkViewer(); };
    </script>
</body>
</html>
